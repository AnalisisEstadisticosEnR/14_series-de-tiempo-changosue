---
title: "problema c02"
author: "Josue"
date: "4/28/2022"
output: word_document
---
 Hacer algunos modelos pronóstico y trazar algunas gráficas para investigar patrones temporales para nuestros datos sobre concentraciones de CO2 en Mauna Loa, Hawái. Ve si puedes predecir la concentración de CO2 para junio de 2050
 
```{r setup, include=FALSE}
library(ggplot2) 
library(forecast)
library(dplyr)
library(colortools)
file.choose()
hawai<- read.csv("/Volumes/macs/documentos mac 5marzo2022/Clase Rstudio/Series-de-tiempo-main/co2_loa.csv",  header=T)
View(hawai)



hawaidata = ts(hawai$co2_conc, start = c(1960, 6), end = c(2005, 6), frequency = 12)
autoplot(hawaidata)



```

## R Markdown


```{r cars}
hawaidatastl <- stl(hawaidata, s.window = "period")
plot(hawaidatastl)

```


```{r pressure, echo=FALSE}
monthplot(hawaidata)
```
```{r}
seasonplot(hawaidata)
```
```{r}
hawai_ets_auto <- ets(hawaidata)
hawai_ets_mmm <- ets(hawaidata, model = "MMM")
hawai_ets_zzz<- ets(hawaidata, model = "ZZZ")
hawai_ets_mmm_damped <- ets(hawaidata, model = "MMM", damped = TRUE)

hawai_ets_fc <- forecast(hawai_ets_auto, h=700)
hawai_ets_mmm_fc <- forecast(hawai_ets_mmm, h=700)
hawai_ets_zzz_fc <- forecast(hawai_ets_zzz, h=700)
hawai_ets_mmm_damped_fc <- forecast(hawai_ets_mmm_damped, h=700)

help("cbind")
hawai_ets_fc_df <- cbind("Month" = rownames(as.data.frame(hawai_ets_fc)), as.data.frame(hawai_ets_fc))
hawai_ets_mmm_fc_df <- cbind("Month" = rownames(as.data.frame(hawai_ets_mmm_fc) ), as.data.frame(hawai_ets_mmm_fc))
hawai_ets_zzz_fc_df <- cbind("Month" = rownames(as.data.frame(hawai_ets_zzz_fc) ), as.data.frame(hawai_ets_zzz_fc))
hawai_ets_mmm_damped_fc_df <- cbind("Month" = rownames(as.data.frame(hawai_ets_mmm_damped_fc)), as.data.frame(hawai_ets_mmm_damped_fc))
View(hawai_ets_fc_df)
View(hawai_ets_mmm_fc_df)
View(hawai_ets_zzz_fc)
View(hawai_ets_mmm_damped_fc_df)

forecast_all <- rbind(hawai_ets_fc_df, hawai_ets_mmm_fc_df,hawai_ets_zzz_fc_df,
                      hawai_ets_mmm_damped_fc_df)

View(forecast_all)

(forecast_plot <- ggplot() +
    geom_line(data = hawai, aes(x = month, y = co2_conc)) + #la información original
    geom_line(data = forecast_all, aes(x = Month, y = `Point Forecast`)) + # el pronóstico
    theme_classic())
           
```
                                    
Salio re mal la gráfica porque no tengo formato de as.Date y por más que hice no se pudo..

```{r}

pfc<- hawai_ets_fc_df %>% filter (Month == "Jun 2050") %>% select (Month, `Point Forecast`)
pmmm<- hawai_ets_mmm_fc_df %>% filter(Month == "Jun 2050") %>% select (Month, `Point Forecast`)
pzzz<- hawai_ets_zzz_fc_df %>% filter(Month == "Jun 2050") %>% select (Month, `Point Forecast`)
pdam<- hawai_ets_mmm_damped_fc_df%>% filter(Month == "Jun 2050") %>% select (Month, `Point Forecast`)
```

No pude cambiar a as.Date desde el principio de mi base de datos, y tampoco en los fc_df... por lo que solo me hizo el cbind se generó con datos de la temporalidad sin estar en ese formato, sin embargo, se realizó el pronóstico. y los datos son: 
```{r}
print(c(pfc,pmmm,pzzz,pdam))
```
Cabe mencionar que hay una sobrelapación con respecto a las metodologias de pronóstico aditivos y los multiplicativos.
Se concluye que en junio de 2050 se estima que los datos de CO2 en Hawai son de 473.6725
